name: Move to In Progress when assigned
on:
  issues:
    types:
      - assigned

jobs:
  move-issue-to-in-progress:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      repository-projects: write

    steps:
      - name: Set up GH CLI with token
        env:
          GH_TOKEN: ${{ secrets.REPO_TOKEN }}
        run: |
          gh config set prompt disabled
          echo "✅ GitHub CLI configured with token"

      - name: Get repository owner
        id: get_owner
        run: |
          OWNER=$(echo "$GITHUB_REPOSITORY" | cut -d'/' -f1)
          echo "OWNER=$OWNER" >> $GITHUB_ENV
        shell: bash

      - name: Get project ID
        id: get_project_id
        run: |
          OWNER=${{ env.OWNER }}
          PROJECT_NAME="Clawtopia" # Altere se seu projeto tiver outro nome

          PROJECT_ID=$(gh api graphql -f query='
            query {
              organization(login: "'$OWNER'") {
                projectV2(number: 1) {
                  id
                }
              }
            }' | jq -r '.data.organization.projectV2.id')

          if [ "$PROJECT_ID" = "null" ]; then
            echo "❌ Failed to find project '$PROJECT_NAME'"
            exit 1
          fi

          echo "PROJECT_ID=$PROJECT_ID" >> $GITHUB_ENV
        shell: bash
        env:
          GH_TOKEN: ${{ secrets.PROJECTS_PAT }}

      - name: Get or add item ID from issue
        id: get_item_id
        run: |
          ISSUE_URL="${
